<!DOCTYPE html>
<html lang="en">
<head>
    <title>Resilience Story of New York</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!--meta data for sharing links on Facebook-->
    <meta property="og:title" content="Resilience New York"/>
    <meta property="og:url" content="http://geoviz.ceoas.oregonstate.edu/storymap/examples/2.5/video.html"/>
    <meta property="og:description" content="Resilience Storymap."/>
    <meta property="og:image" content="../../img/social.png"/>

    <!--add required stylesheets-->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <!--leaflet css-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.4.0/leaflet.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css">

    <!--add favicon for the web page-->
    <link rel="shortcut icon" href="img/favicon.ico" type="image/x-icon">
    <!-- add a favicon of NY big apple from website https://favicon.io/favicon-converter/-->

    <!--Fonts-->
    <link href="https://fonts.googleapis.com/css?family=Cairo" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chroma-js/1.3.4/chroma.min.js"></script>
    <link rel="stylesheet" type="text/css" href="css/storymap.2.5.css">

    <!--add required libraries-->
    <script src="http://cdn.leafletjs.com/leaflet-0.5.1/leaflet.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.4.0/leaflet.js"></script>
    <!--jquery-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js"></script>

    <!--boostrap-->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
    <!--leaflet.ajax for asynchronously adding geojson data-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet-ajax/2.1.0/leaflet.ajax.min.js"></script>

    <!--mini globle map-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/topojson/1.6.19/topojson.min.js"></script>
    <script src="js/Control.GlobeMiniMap.js"></script>

    <!--story map plugin-->
    <script src="js/storymap.2.5.js"></script>

</head>
<body>

<!--Navigations,container,and button -->
<nav class="navbar navbar-expand-lg fixed-top navbar-dark bg-dark storymap-navbar">
  <a class="navbar-brand" href="New-York.png">
   <img src="img/New-York.png" alt="Logo" style="width:35px;">NYS</a>
  <div class="collapse navbar-collapse">
    <ul class="navbar-nav ml-auto">
      <li class="nav-item">
        <a class="nav-link" "=" href="javascript:window.scrollBy(0, $('section[data-scene=\'cases\']').offset().top - $(window).scrollTop() - $('.storymap-navbar').height() - 30);"overview&nbsp;1</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" "=" href="javascript:window.scrollBy(0, $('section[data-scene=\'cases\']').offset().top - $(window).scrollTop() - $('.storymap-navbar').height() - 30);"cases&nbsp;2</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" "=" href="javascript:window.scrollBy(0, $('section[data-scene=\'cases\']').offset().top - $(window).scrollTop() - $('.storymap-navbar').height() - 30);"order&nbsp;3</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" "=" href="javascript:window.scrollBy(0, $('section[data-scene=\'cases\']').offset().top - $(window).scrollTop() - $('.storymap-navbar').height() - 30);"outrage&nbsp;4</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" "=" href="javascript:window.scrollBy(0, $('section[data-scene=\'cases\']').offset().top - $(window).scrollTop() - $('.storymap-navbar').height() - 30);"poverty&nbsp;5</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" "=" href="javascript:window.scrollBy(0, $('section[data-scene=\'cases\']').offset().top - $(window).scrollTop() - $('.storymap-navbar').height() - 30);"volunteer&nbsp;6</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" "=" href="javascript:window.scrollBy(0, $('section[data-scene=\'cases\']').offset().top - $(window).scrollTop() - $('.storymap-navbar').height() - 30);"embrace&nbsp;7</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" "=" href="javascript:window.scrollBy(0, $('section[data-scene=\'cases\']').offset().top - $(window).scrollTop() - $('.storymap-navbar').height() - 30);"end&nbsp;8</a>
      </li>
    </ul>
  </div>
</nav>

<!-- Create Storymap -->
<div id="storymap" class="container-fluid storymap">
  <div class="row">
    <div class="col-sm-6 col-md-4 storymap-story" style="top: 18px;">
      <section data-scene="overview" data-background="img/nyvintage.mp4">
                <div class="fullscreen text-center">
                    <h1 class="display-4 d-flex justify-content-center">Resilience Story of New York</h1>
                    <strong class="d-flex justify-content-center" style="color: rgba(255,255,255,0.95)">This is the resilience story of New York State
                      in the face of COVID-19 pandemic
                    </strong>
                </div>
            </section>

            <section data-scene="cases" class="visible viewing" style="background-color:black; color:white;"> <!-- alternatively use class='invisible' -->
              <h2><b>The Pandemic</b></h2>
              <p>The coronavirus spread in the U.S. since March 2020 had drastically changed the way people live their lives. Compared to other states, the rapid spread of the virus in NY clearly signaled an urgent call of taking extreme measures, similar
              to what China and South Korea had done: lockdown and social distancing. The independent expert maintained that people in poverty are disproportionately threatened by the coronavirus.
              “They are more likely to work in jobs with a high risk of exposure, live in crowded and insecure housing, reside in neighbourhoods that are more vulnerable because of air pollution,
              and lack access to healthcare”, he said.“Communities of colour, who face a persistent racial wealth gap, are at particular risk and are dying at much higher rates.”
              Additionally, the poor have fewer resources to cushion economic blows and are more susceptible to mass layoffs and pay cuts. </p>
              <img src="img/NYC_compare.jpg" width="400px" height="200px" class="img-responsive img-thumbnail" alt="responsive image" alt-text="Compared to other states">
              <p style="text-align:center;"><a href="https://untappedcities.com/2016/06/24/lost-in-old-new-york-vintage-photos-from-the-museum-of-the-city-of-new-york/">Countesy of Untapped Cities</a></p>
              <br>
              <p>The fines for people not allowing the governor's executive order was between $500 and $ 1,000. The New York Governor stated that people did not take the order serioulsly</p>
              <img src="img/covid_patient.jpg" width="500px" height="300px" class="img-responsive img-thumbnail" alt="responsive image" alt-text="Stucked with Coronavirus">
              <p style="text-align:center;"><a href="https://untappedcities.com/2016/06/24/lost-in-old-new-york-vintage-photos-from-the-museum-of-the-city-of-new-york/">Countesy of MCNY</a></p>
              <p>People shared their personal stories in the face of the pandemic and asked one to another: "What's Your Quarantine Routine?" Others expressed their feelings through sketches.</p>
              <img src="img/NYC_Adinatudor_sketch.jpg" width="500px" height="300px" class="img-responsive img-thumbnail" alt="responsive image" alt-text="Stucked with Coronavirus">
              <p style="text-align:center;"><a href="https://www.nytimes.com/2020/03/30/us/coronavirus-world-news-updates.html">Countesy of NY Times</a></p>
            </section>

            <section data-scene="order" class="visible viewing" style="background-color:black; color:white;">
              <h2><b>Perceptions on Stay At Home Order</b></h2>
              <p>As the US grapples with the rapid spread of the coronavirus that has the health care system at a tipping point, a growing number of states ordered their residents to stay at home.
                Despite the White House has advised all Americans to practice social distancing, the number of coronavirus cases in the US continues to rise. Governors then took stronger action by issuing stay-at-home orders.
                People reacted to this with different perceptions. Some believed the order is inconstitutional, while others believed it is a necessary step. The map shows the distribution of public perception
                on stay at home order retrieved from social media Twitter using data crawling technique. </p>
              <img src="img/stay.jpg" width="500px" height="300px" class="img-responsive img-thumbnail" alt="responsive image" alt-text="outrage">
              <p style="text-align:center;"><a href="https://www.mlive.com/public-interest/2020/04/whats-the-difference-between-michigans-stay-at-home-order-and-state-of-emergency.html">Countesy of DesOrmeau</a></p>
              <img src="img/tweet1.png" width="100%" height="100%" class="img-responsive img-thumbnail" alt="responsive image" alt-text="tweet2"><br>
              <img src="img/tweet2.png" width="100%" height="100%" class="img-responsive img-thumbnail" alt="responsive image" alt-text="tweets">
              <!-- <p><iframe border=0 frameborder=0 height=100% width=100% src="https://twitter.com/WearAMaskPeeps/status/1268959235611652096"></iframe></p>
              <br> -->
              <!-- <p>On March 22, 2020, Governor Cuomo announced the New York State on PAUSE executive order which consists of 10-point policies to prevent the spread. The maximum fine of the state's pysical distancing protocol is $1,000. </p>
                <img src="img/NY_governor.jpg" width="500px" height="300px" class="img-responsive img-thumbnail" alt="responsive image" alt-text="outrage">
                <p style="text-align:center;"><a href="https://www.forbes.com/sites/sergeiklebnikov/2020/04/07/new-york-sees-highest-daily-death-toll-but-cuomo-insists-social-distancing-is-working/#3c1fb5459989">Countesy of Forbes</a></p> -->
            </section>

            <section data-scene="outrage" class="visible viewing" style="background-color:black; color:white;">
                <h2><b>Protests & Gun Ownership</b></h2>
                <p>Citizens of New York State have diffeent responses to this policy. In NYC for instance, a great number of people flocked to parks, disobeying the social distancing order. This raises
                questions of how the government would enforce the stay-at-home policies. Protests taken place throughout the U.S including NYS, criticizing the government's rule of lockdown as it will
                create more economic problem and unemployment</p>
                <img src="img/NY_protests.jpg" width="500px" height="300px" class="img-responsive img-thumbnail" alt="responsive image" alt-text="outrage">
                <p style="text-align:center;"><a href="https://www.axios.com/coronavirus-protest-social-distancing-1bc7fb5a-b94c-471e-adf2-c50bfad4f242.html">Countesy of Axios</a></p>
                At least nine shootings took place as government released the social distancing and statewide lockdown in March 2020. The incidents have caused at least 4 dead victims and 7 injured
                The map shows the distribution of registered guns throughout the U.S. which among other factors, indicates the high potentials of such violence to re-occur during this uncertain time.
                <img src="img/NY_protest_guns.jpg" width="500px" height="300px" class="img-responsive img-thumbnail" alt="responsive image" alt-text="outrage">
                <p style="text-align:center;"><a href="https://www.latimes.com/opinion/story/2020-04-17/column-gun-toting-republicans-ignoring-quarantine-orders-yes-even-coronavirus-has-become-part-of-the-culture-wars">Countesy of LA Times</a></p>
                <br>
            </section>

            <section data-scene="poverty" class="visible viewing" style="background-color:black; color:white;">
                <h2><b>Violence and Poverty</b></h2>
                <!-- <p>New York was once named New Amsterdam, given by the Dutch who colonized this area along the Hudson River in 1624. It is under the reign of
                British Empire 40 years later that the name turned into New York. The New York State had significant role in American Revolution and long been a
                magnet for immigrants worldwide to work and reside. New York City is the largest city in the state and a home for nearly 20 million people.</p>
                <img src="img/NYC_vintage.jpg" width="500px" height="300px" class="img-responsive img-thumbnail" alt="responsive image" alt-text="Old New York">
                <p style="text-align:center;"><a href="https://untappedcities.com/2016/06/24/lost-in-old-new-york-vintage-photos-from-the-museum-of-the-city-of-new-york/">Countesy of MCNY</a></p>
                <br>
                <p>The state has 62 counties which are divided into about 1,500 towns and villages. Compared to other county governments, New Yowk relatively has a stronger governance with
                  many special districts and infrastructures like port, bridge, health, and regional market. The Port Authority is one of the largest special districts operating harbors and related facilities throughout New York City and New Jersey.</p>
                <img src="img/NYC_night2.jpg" width="500px" height="300px" class="img-responsive img-thumbnail" alt="responsive image"alt-text="NYC at midgnight">
                <p style="text-align:center;"><a href="https://www.pinterest.com/pin/171629435785355627">Countesy of PhotoMagazine</a></p>
                <br> -->
                <p>Being one of the wealthiest states in the USA does not mean that New York State does not struggle with issue of homelessness and poverty.
                  Leading the nation with the greatest divide between the wealthiest 1 percent of residents and the other 99 percent was New York state, according to the report by the Economic Policy Institute, a left-leaning think tank in Washington, D.C.
                  The average income of the top 1 percent in New York state was $2.2 million in 2015, while the average income of the bottom 99 percent was $49,617. The economy inequity is also associated with ethnicity and race. The map shows the Median
                  household income level throughout the U.S. states in 2020.</p>
                <img src="img/NY_poverty.jpg" width="500px" height="300px" class="img-responsive img-thumbnail" alt="responsive image"alt-text="NYC at midgnight">
                <p style="text-align:center;"><a href="https://theneworleanstribune.com/what-others-are-saying-homelessness-crisis-we-are-better-than-this/">Countesy of Julianne Malveaux</a></p>
            </section>

            <section data-scene="volunteer" class="visible viewing" style="background-color:black; color:white;">
                <h2><b>Networking</b></h2>
                <p>People are called to volunteer in this difficult and uncertain condition in New York. The map shows some of almost 150 food pantries that voluntarily provides
                  people with free food during the pandemic. Most of the pantries are organized by church and ethnicity-based institutions, and surprisingly, relied on retired seniors.
                  Since they can no longer safely leave their homes, the food pantry and kitchen are today run by young volunteers.
              </p>
                <img src="img/NY_volunteer1.jpg" width="500px" height="300px" class="img-responsive img-thumbnail" alt="responsive image" alt-text="farmer">
                <p style="text-align:center;"><a href="https://www.nytimes.com/2020/04/08/business/economy/coronavirus-food-banks.html">Countesy of New York Times</a></p>
                <p>Besides foods, many organizations are now opening their doors to welcome homeless by providing them with shelters, transitional housing
                and services. These organizations normally required the homeless people to show their ID or proof of residence. One of these organizations is located on Winchester Blvd.</p>
                <img src="img/NY_volunteer2.jpeg" width="500px" height="300px" class="img-responsive img-thumbnail" alt="responsive image" alt-text="farmer">
                <p style="text-align:center;"><a href="https://www.cnbc.com/2020/04/25/making-sense-of-a-stock-market-just-16percent-off-its-high-while-a-pandemic-costs-26-million-jobs.html">Countesy of New York Times</a></p>
            </section>

            <section data-scene="end" data-background="img/NY_worktogether.jpg">
                <div class="fullscreen text-center">
                    <h1 class="display-4 d-flex justify-content-center" style="background:black"></h1>
                    <small class="d-flex justify-content-center" style="color: rgba(255,255,255,0.95)">This project is dedicated foremostly for all the frontliners who unrestlessly fight
                      against the pandemic spread and the New York state's citizens who will prove their resistance to the pandemic through social acts and contributions.
                    </small>
                </div>
            </section>
        </div>

        <!--map div-->
        <div class="col-sm-6 col-md-8 storymap-map leaflet-container leaflet-touch leaflet-retina leaflet-fade-anim" tabindex="0" style="outline: 2px dashed blue;">
          <div class="leaflet-pane leaflet-map-pane" style="transform: translate3d(166px, -199px, 0px);">
            <div class="leaflet-pane leaflet-tile-pane">
            <div class="leaflet-layer " style="z-index: 1; opacity: 1;">
              <div class="leaflet-tile-container leaflet-zoom-animated" style="z-index: 18; transform: translate3d(-234px, -137px, 0px) scale(1);">
                <img alt="" role="presentation" src="http://cartodb-basemaps-c.global.ssl.fastly.net/dark_all/10/161/369@2x.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(734px, 224px, 0px); opacity: 1;">
                <img alt="" role="presentation" src="http://cartodb-basemaps-a.global.ssl.fastly.net/dark_all/10/161/370@2x.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(734px, 480px, 0px); opacity: 1;">
                <img alt="" role="presentation" src="http://cartodb-basemaps-b.global.ssl.fastly.net/dark_all/10/160/369@2x.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(478px, 224px, 0px); opacity: 1;">
                <img alt="" role="presentation" src="http://cartodb-basemaps-a.global.ssl.fastly.net/dark_all/10/162/369@2x.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(990px, 224px, 0px); opacity: 1;">
                <img alt="" role="presentation" src="http://cartodb-basemaps-c.global.ssl.fastly.net/dark_all/10/160/370@2x.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(478px, 480px, 0px); opacity: 1;">
                <img alt="" role="presentation" src="http://cartodb-basemaps-b.global.ssl.fastly.net/dark_all/10/162/370@2x.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(990px, 480px, 0px); opacity: 1;">
                <img alt="" role="presentation" src="http://cartodb-basemaps-a.global.ssl.fastly.net/dark_all/10/159/369@2x.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(222px, 224px, 0px); opacity: 1;">
                <img alt="" role="presentation" src="http://cartodb-basemaps-b.global.ssl.fastly.net/dark_all/10/163/369@2x.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(1246px, 224px, 0px); opacity: 1;">
                <img alt="" role="presentation" src="http://cartodb-basemaps-b.global.ssl.fastly.net/dark_all/10/159/370@2x.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(222px, 480px, 0px); opacity: 1;">
                <img alt="" role="presentation" src="http://cartodb-basemaps-c.global.ssl.fastly.net/dark_all/10/163/370@2x.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(1246px, 480px, 0px); opacity: 1;">
                <img alt="" role="presentation" src="http://cartodb-basemaps-c.global.ssl.fastly.net/dark_all/10/158/369@2x.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(-34px, 224px, 0px); opacity: 1;">
                <img alt="" role="presentation" src="http://cartodb-basemaps-c.global.ssl.fastly.net/dark_all/10/164/369@2x.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(1502px, 224px, 0px); opacity: 1;">
                <img alt="" role="presentation" src="http://cartodb-basemaps-a.global.ssl.fastly.net/dark_all/10/158/370@2x.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(-34px, 480px, 0px); opacity: 1;">
                <img alt="" role="presentation" src="http://cartodb-basemaps-a.global.ssl.fastly.net/dark_all/10/164/370@2x.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(1502px, 480px, 0px); opacity: 1;">
              </div>
            </div>
          </div>
          <div class="leaflet-pane leaflet-shadow-pane">
          </div>
          <div class="leaflet-pane leaflet-overlay-pane">
          </div>
          <div class="leaflet-pane leaflet-marker-pane">
          </div>
          <div class="leaflet-pane leaflet-tooltip-pane">
          </div>
          <div class="leaflet-pane leaflet-popup-pane">
          </div>
          <div class="leaflet-proxy leaflet-zoom-animated" style="transform: translate3d(41291.5px, 94741px, 0px) scale(512);">
          </div>
        </div>
      </div>
    </div>
  </div>

  <!--arrow-->
  <div class="zoomIn infinite material-icons d-flex fixed-bottom mb-5 storymap-scroll-down justify-content-left">keyboard_arrow_down
  </div>
  <div class="storymap-progressline" style="width: 6.2383%;">
  </div>

  <!-- icons -->
    <dl>
        <dt>
            <!--facebook icon-->
            <a class="fab fa-facebook-square btn" href="https://facebook.com/sharer.php?u=http://geoviz.ceoas.oregonstate.edu/storymap/examples/2.5/video.html" style="top:60px"
               target="_blank"></a>
        </dt>
        <dt>
            <!--facebook icon-->
            <a class="fab fa-github btn" href="https://github.com/catharinadepari/storymap" style="top:80px"
               target="_blank"></a>
        </dt>
        <dt>
            <!--info icon-->
            <i class="fas fa-info-circle btn" style="top:100px" data-toggle="modal" data-target="#info-modal"></i>
        </dt>
    </dl>

    <!--the info page-->
    <div class="modal fade" id="info-modal" role="dialog">
        <div class="modal-dialog modal-md">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">About</h4>
                </div>
                <div class="modal-body">
                    <p>This is a web map of resilience story of New York, which is a part of final project of GEOG 458
                      at the University of Washington,Seattle</p>
                    <p><b>storymap.js</b> | Released Date: 02/20/2017 | Version: 2.5 | MIT License </p>
                    <p><b>Author: Catharina Depari</b> | University of Washington | Seattle
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- main javascript -->
<script type="text/javascript">

    //create color for CASES layer
    function getColor(d) {
      return d > 300000 ? '#7a0177' :
          d > 200000  ? '#ae017e' :
          d > 100000 ? '#dd3497' :
          d > 50000  ? '#f768a1' :
          d > 25000   ? '#fa9fb5' :
          d > 10000   ? '#fcc5c0' :
          d > 5000   ? '#fde0dd' :
          d > 2500   ? '#fde0dd' :
          d > 1000   ? '#fde0dd' :
                '#fff7f3';
          }
    // Set style function that sets fill color.md
    function style(feature) {
      return {
        fillColor: getColor(feature.properties.cases),
        fillOpacity: 0.7,
        weight: 0.6,
        dashArray: '',
        opacity: 0.6,
        color: 'black'
      };
    }
    var cases_legend = L.control({position: 'topleft'});

    cases_legend.onAdd = function (map) {
      var div = L.DomUtil.create('div', 'cases_legend'),
      grades = [1000, 500, 250, 100, 50, 25, 10],
      labels = [],
      from, to;
      for (var i = 0; i < grades.length; i++) {
        from = grades[i];
        to = grades[i + 1];
        labels.push(
          '<i style="background:' + getColor(from + 1) + '"></i> ' +
          from + (to ? '&ndash;' + to : '+'));
        }
        div.innerHTML = labels.join('<br>');
        return div;
      };

      // create legend for cases layers
      var cases_legend = '<i style="background-color:#7a0177; opacity: 0.6"></i><p><b>300k+</b></p>' +
        '<i style="background-color:#ae017e; opacity: 0.6"></i><p><b>200k-300k</b></p>'+
        '<i style="background-color:#dd3497; opacity: 0.6"></i><p><b>100k-200k</b></p>'+
        '<i style="background-color:#f768a1; opacity: 0.6"></i><p><b>50k-100k</b></p>'+
        '<i style="background-color:#fa9fb5; opacity: 0.6"></i><p><b>25k-50k</b></p>' +
        '<i style="background-color:#fcc5c0; opacity: 0.6"></i><p><b>10k-25k</b></p>'+
        '<i style="background-color:#fde0dd; opacity: 0.6"></i><p><b>5k-10k</b></p>'+
        '<i style="background-color:#fff7f3; opacity: 0.6"></i><p><b><2.5k-5k</b></p>'+
        '<i style="background-color:#fff7f3; opacity: 0.6"></i><p><b><1k-2.5k</b></p>'+
        '<i style="background-color:#fff7f3; opacity: 0.6"></i><p><b>>1k</b></p>';

    //create color for OUTRAGE layer
    function out_color(d) {
      return d > 500 ? '#e32719' :
          d > 400  ? '#c3452b' :
          d > 300 ? '#c65827' :
          d > 200  ? '#c76923' :
          d > 100   ? '#c57b21' :
          d > 70  ? '#c28c20' :
          d > 50   ? '#bd9c23' :
          d > 30 ? '#b8ac28' :
          d > 15  ? '#b1ba2f' :
                '#aac838';
          }
    function out_style(feature) {
      return {
        fillColor: out_color(feature.properties.NYS_Violence_Fire_rate),
        fillOpacity: 0.7,
        weight: 0.6,
        dashArray: '',
        opacity: 0.6,
        color: 'black'
      };
    }

    //create color for poverty layers
    function pov_color(d) {
      return d > 60000 ? '#6d5cc8' :
          d > 50000  ? '#c564a6' :
          d > 40000 ? '#ef798c' :
          d > 30000  ? '#f49b88' :
          d > 20000   ? '#eac29f' :
                '#e9e6cf';
          }
    function pov_style(feature) {
      return {
        fillColor: pov_color(feature.properties.newmed_medinco),
        fillOpacity: 0.7,
        weight: 0.6,
        dashArray: '',
        opacity: 0.6,
        color: 'black'
      };
    }

    // create layers
    var layers = {
      cases: {
        layer: L.geoJson.ajax('assets/uscases.geojson', {
          style: style,
        onEachFeature: function (feature, layer) {
          layer.bindPopup("<h6><b>county:</h6></b>" + feature.properties.name + " " +"<h6><b>cases:</h6></b>" + feature.properties.cases,
          {sticky: false, className: "feature-label", permanent: false, offset: [-1, -1]});
        }
      }), legend: cases_legend
    },

    order: {
      layer: L.geoJson.ajax('assets/tweets.geojson', {
        onEachFeature: function (feature, layer) {
            layer.bindPopup("<h3>twitter</h3>" + feature.properties.text);
        },
        pointToLayer: function (feature, latlng) {
            return L.marker(latlng, {icon: L.divIcon({
              html: '<i class="fab fa-twitter" style="font-size:10px;color: #2876db"></i>',
              iconSize: [30, 30],
              className: 'myDivIcon'
            })
          });
        },
      }),
    },

    outrage: {
      layer: L.geoJson.ajax('assets/nys_viol_rate.geojson', {
        style: out_style,
      onEachFeature: function (feature, layer) {
          layer.bindPopup("<h6><b>County:</b></h6>" + feature.properties.NAME + " " +"<h6><b>Firearm Violence Rate:</b></h6>" + feature.properties.NYS_Violence_Fire_rate,
          {sticky: true, className: "feature-label", permanent: false, direction: "center"});
        },
      }),
    },

    poverty: {
      layer: L.geoJson.ajax('assets/nyspvt.geojson', {
        style: pov_style,
        onEachFeature: function (feature, layer) {
          layer.bindPopup("<p><b>County</p></b>" + feature.properties.County + " " +"<p><b>Income</p></b>" + feature.properties.newmed_medinco,
            {sticky: true, className: "feature-label", permanent: false, direction: "center"});
          },
        }),
      },

    volunteer: {
      layer: L.geoJson.ajax('assets/food.geojson', {
        onEachFeature: function (feature, layer) {
            layer.bindPopup("<h3>food pantry</h3>" + feature.properties.text);
        },
        pointToLayer: function (feature, latlng) {
            return L.marker(latlng, {icon: L.divIcon({
              html: '<i class="fas fa-map-pin" style="font-size:25px;color: #a2c036"></i>',
              iconSize: [30, 30],
              className: 'myDivIcon'
            })
          });
        },
      }),
    },

    mask: {
      layer: L.geoJson.ajax('assets/masks.geojson', {
        onEachFeature: function (feature, layer) {
            layer.bindPopup("<h3>face covering</h3>" + feature.properties.text);
        },
        pointToLayer: function (feature, latlng) {
          return L.marker(latlng, {icon: L.divIcon({
            html: '<i class="far fa-flag" style="font-size:25px;color: #a2c036"></i>',
            iconSize: [30, 30],
            className: 'myDivIcon'
          })
        });
      },
    }),
  },

   //tiled maps
   mytile: {
     layer: L.tileLayer('assets/tiles/{z}/{x}/{y}.png', {
       maxZoom: 5,
       tms: true,
       attribution: 'Generated by QMetaTiles'
     }),
   },

    antique: {
      layer: L.tileLayer('https://cartocdn_{s}.global.ssl.fastly.net/base-antique/{z}/{x}/{y}.png')
    },

    stadia: {
      layer: L.tileLayer('https://tiles.stadiamaps.com/tiles/alidade_smooth_dark/{z}/{x}/{y}{r}.png', {
      	attribution: '&copy; <a href="https://stadiamaps.com/">Stadia Maps</a>, &copy; <a href="https://openmaptiles.org/">OpenMapTiles</a> &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors'
      })
    },

     antique: {
       layer: L.tileLayer('https://cartocdn_{s}.global.ssl.fastly.net/base-antique/{z}/{x}/{y}.png')
     },

     esri_gray: {
       layer: L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Base/MapServer/tile/{z}/{y}/{x}', {
         attribution: 'Tiles &copy; Esri &mdash; Esri, DeLorme, NAVTEQ',
         detectRetina: true
       })
     },

    // Basemap
    cartodb_dark: {
      layer: L.tileLayer('http://cartodb-basemaps-{s}.global.ssl.fastly.net/dark_all/{z}/{x}/{y}@2x.png', {
        attribution: "Generated by QMetaTiles",
        detectRetina: true
      })
    }
  };

  //fly
  // bronx: 40.8448, -73.8648
  //NYstate: 43.00035 -75.4999
  //USA: 37.6 -95.665

    var scenes = {
        overview: {lat:37.6, lng: -95.665, zoom: 7, name: 'overview', layers: []},
        cases: {lat:37.6, lng: -95.665, zoom: 3.8, name: 'cases', layers: [layers.cases]}, //cases of covid, scale: US
        order: {lat:37.6, lng: -95.665, zoom: 3.8, name: 'order', layers: [layers.cases, layers.order]}, //tweets scale: NYS
        outrage: {lat:43.00035, lng: -75.4999, zoom: 6.5, name: 'outrage', layers: [layers.outrage]}, // protests, USA
        poverty: {lat:43.00035, lng: -75.4999, zoom: 6.5, name: 'poverty', layers: [layers.poverty]}, // income level, scale : NYS
        volunteer: {lat:43.00035, lng: -75.4999, zoom: 6.5, name: 'volunteer', layers: [layers.volunteer, layers.mask, layers.poverty]}, // food, scale: Bronx, NYC
        end: {lat:40.8448, lng: -73.8648, zoom: 4, name: 'end'}
    };

    $('#storymap').storymap({
        scenes: scenes,
        layers: layers,
        baselayer: layers.cartodb_dark,
        legend: true,
        navbar: true,
        credits: "",
        loader: true,
        scalebar: false,
        scrolldown: true,
        flyo: true,
        progressline: true,
        navwidget: true,

        // createMap: function () {
        createMap: function () {
            var map = L.map($(".storymap-map")[0], {
              center: [50,10],
              zoom: 15,
              maxZoom: 18,
              attributionControl: false,
              zoomControl: false,
              scrollWheelZoom: true,
              doubleClickZoom: true,
              dragging: true,
              animate: true,
              fadeAnimation: true,
              zoomAnimation: true,
              easeLinearity: 0.35,
              gestureHandling: 'cooperative'
            }).setView([40.80312772327861, -74.25052800770425], 2.5);

            //Static scroll wheel Zoom
            // map.on('click', function() {
            //   if (map.scrollWheelZoom.enabled()) {
            //     map.scrollWheelZoom.disable();
            //   }
            //   else {
            //     map.scrollWheelZoom.enable();
            //   }
            // });

            // animated zoom
              map.on('click',
              function(e){
                var coord = e.latlng.toString().split(',');
                var lat = coord[0].split('(');
                var lng = coord[1].split(')');
                console.log("You clicked the map at latitude: " + lat[1] + " and longitude:" + lng[0]);

              map.flyTo([40.8448, -73.8648], 11, {
                animate: true,
                duration: 2 //
              });
            });
            //erase HERE

            //fly
            // bronx: 40.8448, -73.8648
            //NYstate: 43.00035 -75.4999
            //USA: 37.6 -95.665

            // add an miniglobe
            var miniglobe = new L.Control.GlobeMiniMap({
              marker: 'red',
              position: 'bottomright',
              topojsonSrc: 'js/world.json',
              attribution: 'Chris Whong'// https://github.com/chriswhong/leaflet-globeminimap/blob/master/example/index.html
            }).addTo(map);

            //add zoom control with your options
            L.control.zoom({
              position:'bottomright'
            }).addTo(map);

            return map;
        }
    });
</script>
<div class="storymap-trigger" style="top: 30%;">
</div>
</body>
</html>
