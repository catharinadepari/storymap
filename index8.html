<!DOCTYPE html>
<html lang="en">
<head>
    <title>Resilience Story of New York</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!--meta data for sharing links on Facebook-->
    <meta property="og:title" content="New York Towards New Normal"/>
    <meta property="og:url" content="http://geoviz.ceoas.oregonstate.edu/storymap/examples/2.5/video.html"/>
    <meta property="og:description" content="Resilience Storymap."/>
    <meta property="og:image" content="../../img/social.png"/>

    <!--add required stylesheets-->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <!--leaflet css-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.4.0/leaflet.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css">

    <!--add favicon for the web page-->
    <link rel="shortcut icon" href="../../img/favicon.ico" type="image/x-icon">

    <!--Fonts-->
    <link href="https://fonts.googleapis.com/css?family=Cairo" rel="stylesheet">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/chroma-js/1.3.4/chroma.min.js"></script>

    <link rel="stylesheet" type="text/css" href="css/storymap.2.5.css">

    <!--add required libraries-->

    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.4.0/leaflet.js"></script>
    <!--jquery-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js"></script>

    <!--boostrap-->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
    <!--leaflet.ajax for asynchronously adding geojson data-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet-ajax/2.1.0/leaflet.ajax.min.js"></script>

    <!--mini globle map-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/topojson/1.6.19/topojson.min.js"></script>
    <script src="../../js/globeminimap.js"></script>

    <!--story map plugin-->
    <script src="js/storymap.2.5.js"></script>
</head>
<body>

<div id="storymap" class="container-fluid">

<!--Navigations,container,and button -->
<nav class="navbar navbar-expand-md bg-dark navbar-dark sticky-top">
<div class="container-fluid">
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive">
    <span class="navbar-toggler-icon"></span>
  </button>
  <div class="collapse navbar-collapse" id="navbarResponsive">
    <ul class="navbar-nav ml-auto">
      <li class="nav-item active">
        <a class="nav-link" href="#">Home</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="description.html">Description</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="contact.html">Contact</a>
      </li>
    </ul>
  </div>
</div>
</nav>

    <div class="row">
        <div class="col-sm-6 col-md-4 storymap-story">
            <section data-scene="overview" data-background="img/nyvintage.mp4">
                <div class="fullscreen text-center">

                    <h1 class="display-4 d-flex justify-content-center">Resilience Story of New York</h1>

                    <strong class="d-flex justify-content-center" style="color: rgba(255,255,255,0.95)">This is the resilience story of New York State
                      in the face of COVID-19 pandemic
                    </strong>
                </div>
            </section>
            <section data-scene="newyork" style="background-color:black; color:white;">
                <h2><b>396-Year Old New York</b></h2>
                <p>New York was a colony of the Dutch who settled along the Hudson River in 1624 under the name of New Amsterdam. The reign of
                British Empire 40 years later changed the history of the state as well as its name into New York. The New York State had significant
                role in the American Revolution and been a magnet for immigrants to work and settle. New York City is the largest city in the state,
                a home for almost 20 million people and the center of international economy via its New York Stock Exchange.</p>
                <img src="img/NYC_vintage.jpg" width="500px" height="300px" class="img-responsive img-thumbnail" alt="responsive image" alt-text="Old New York">
                <p style="text-align:center;"><a href="https://untappedcities.com/2016/06/24/lost-in-old-new-york-vintage-photos-from-the-museum-of-the-city-of-new-york/">Countesy of MCNY</a></p>
                <br>
                <h2><b>I Love New York</b></h2>
                <p>The state has 62 counties which are divided into about 1,500 towns and villages. Unlike other states in which either town or county government is relatively weak, New Yowk has a strong governance.
                xpecial districts include port and bridge, health, and regional market authorities. The Port Authority is one of the largest special districts
                operating harbors and related facilities throughout New York City and New Jersey.</p>
                <img src="img/NYC_night2.jpg" width="500px" height="300px" class="img-responsive img-thumbnail" alt="responsive image"alt-text="NYC at midgnight">
                <p style="text-align:center;"><a href="https://www.pinterest.com/pin/171629435785355627">Countesy of PhotoMagazine</a></p>
            </section>

            <section data-scene="dilema" style="background-color:black; color:white;">
              <h2><b>21st Century Dark Age</b></h2>
              <p>The coronavirus spread in the U.S. since March 2020 had drastically changed the way people live their lives. New York, specifically the NYC is the epicenter of the Pandemic in the U.S.
              Today, the confirmed cases has reached about ..... and .... deaths. Compared to other states, the rapid spread of the virus in NY clearly signaled an urgent call of taking extreme measures, similar
              to what China and South Korea had done: lockdown and social distancing </p>
              <img src="img/NYC_compare.jpg" width="500px" height="300px" class="img-responsive img-thumbnail" alt="responsive image" alt-text="Compared to other states">
              <br>
              <h2><b>Trapped</b></h2>
              <p>New York is .</p>
              <img src="img/NYC_corona.jpg" width="500px" height="300px" class="img-responsive img-thumbnail" alt="responsive image" alt-text="Stucked with Coronavirus">
              <p>New York</p>
              <h2><b>Dilemmatic Physical Distancing</b></h2>
              <p>Twitter .</p>
              <img src="assets/NYC_covid.jpg" width="500px" height="300px" class="img-responsive img-thumbnail" alt="responsive image" alt-text="Stucked with Coronavirus">
            </section>

            <section data-scene="outrage" style="background-color:black; color:white;">
                <h2><b>The Outrage</b></h2>
                <p>people got angry.</p>
                <img src="img/NYC_covid.jpg" width="500px" height="300px" class="img-responsive img-thumbnail" alt="responsive image" alt-text="outrage">
                <br>
                <h2><b>Government's Reactions</b></h2>
                <p>Farmer market, facial mask for the frontliners.</p>
                <img src="img/NYC_covid.jpg" width="500px" height="300px" class="img-responsive img-thumbnail" alt="responsive image" alt-text="government">
            </section>

            <section data-scene="heroism" style="background-color:black; color:white;">
                <h2><b>Food Pantry and Shelters</b></h2>
                <p>People are called to volunteer in this difficult and uncertain condition in New York. Take Queens Village as the example. Through the Hunter College NYC Food
                Policy Center, this Village provided millions of New Yorkers with free food and meals for their survival. Surprisingly, the pantry itself has relied on retired seniors
                in its operation. Since they can no longer safely leave their homes, the food pantry and kitchen are today run by young volunteers.
              </p>
                <img src="img/NYC_covid.jpg" width="500px" height="300px" class="img-responsive img-thumbnail" alt="responsive image" alt-text="farmer">
                <p>The interactive map shows us the distribution of each food pantry organized by the Hunter College NYC Policy Center. There are 21 food pantries organized by different
                church in this state and Village. Beside foods, many organizations are now opening their doors to welcome the homeless by providing them with shelters, transitional housing
                and services without exemption. These organizations normally required the homeless people to show their ID or proof of residence. One of these organizations is located on Winchester Blvd.</p>
                <h2><b>Environment</b></h2>
                <p>The quality of our environment .</p>
                <img src="img/NYC_covid.jpg" width="500px" height="300px" class="img-responsive img-thumbnail" alt="responsive image" alt-text="environment">
                <p>....</p>
            </section>

            <section data-scene="resilience" style="background-color:black; color:white;">
                <h2><b>Changing the Mindset</b></h2>
                <p>Resilience.</p>
                <img src="../../img/oregon_flag.png" class="img-responsive img-thumbnail" alt="responsive image"
                     alt-text="change the mindset">
                <p>Then, ...</p>
            </section>

            <section data-scene="end" data-background="assets/end.jpg">
                <div class="fullscreen text-center">
                    <h1 class="display-4 d-flex justify-content-center">Let's Embrace the New Normal</h1>
                    <small class="d-flex justify-content-center" style="color: rgba(255,255,255,0.95)">Your
                        Acknowledgement goes here
                    </small>
                </div>
            </section>

        </div>
        <!--map div-->
        <div class="col-sm-6 col-md-8 storymap-map"></div>
    </div>

    <dl>
        <dt>
            <!--facebook icon-->
            <a class="fab fa-facebook-square btn"
               href="https://facebook.com/sharer.php?u=http://geoviz.ceoas.oregonstate.edu/storymap/examples/2.5/video.html" style="top:40px"
               target="_blank"></a>
        </dt>
        <dt>
            <!--facebook icon-->
            <a class="fab fa-github btn" href="https://github.com/jakobzhao/storymap" style="top:60px"
               target="_blank"></a>
        </dt>
        <dt>
            <!--info icon-->
            <i class="fas fa-info-circle btn" style="top:80px" data-toggle="modal" data-target="#info-modal"></i>
        </dt>
    </dl>

    <!--the info page-->
    <div class="modal fade" id="info-modal" role="dialog">
        <div class="modal-dialog modal-md">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">About</h4>
                </div>
                <div class="modal-body">
                    <p>This is a web map of major cities in Oregon. It is mainly made as a demo for a course GEOG 371:
                        Web Mapping provided by Oregon State University. The story map library is derived from the
                        storymap plugin for leaflet at <a>http://atlefren.github.io/storymap/</a>, and its functionality
                        relies on both leaflet and Boostrap.</p>
                    <p><b>storymap.js</b> | Released Date: 02/20/2017 | Version: 2.5 | MIT License </p>
                    <p><b>Author: Bo Zhao</b> | College of Earth, Ocean, Atmospheric Science | Oregon State University
                    </p>
                    <p>The context about Oregon cities was collected from Wikipedia.</p>
                    <p>The <a href="https://www.youtube.com/watch?v=UJ_vQC9PNY4">background video</a> on the front page
                        was clipped from Youtube. </p>
                    <p>The favicon image was acquired from <a>http://www.udlcenter.org/advocacy/state/oregon.</a></p>
                    <p>This story map uses geospatial data from mapbox, Google Earth Engine, ESRI Map, Open Street Maps
                        and Oregon Explorer.</p>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- main javascript -->
<script type="text/javascript">

    // Build up a set of colors from chroma category for Covid-19 cases in NYS
    var colors = chroma.scale(['lightyellow', 'darkred']).mode('lch').colors(7);
    function setColor(d) {
        var id = 0;
        if (d > 1000) { id = 6; }
        else if (d > 500) { id = 5; }
        else if (d > 400) { id = 4; }
        else if (d > 300) { id = 3; }
        else if (d > 200) { id = 2; }
        else if (d > 100) { id = 1; }
        else  { id = 0; }
        return colors[id];
      }
      // Set style function that sets fill color.md property
      function style(feature) {
          return {
              fillColor: setColor(feature.properties.cases),
              fillOpacity: 0.6,
              weight: 1,
              dashArray: '',
              opacity: 1,
              color: 'white'
          };
      }
    // Create Legend Contents in html format
    var newyork_legend = L.control({position: 'topright'});
    newyork_legend.onAdd = function () {
        // Create Div Element and Populate it with HTML
        var div = L.DomUtil.create('div', 'newyork_legend');
        div.innerHTML += '<b>Confirmed Cases</b><br />';
        div.innerHTML += '<i style="background: ' + colors[6] + '; opacity: 0.7"></i><p>1000+</p>';
        div.innerHTML += '<i style="background: ' + colors[5] + '; opacity: 0.7"></i><p>500-1000</p>';
        div.innerHTML += '<i style="background: ' + colors[4] + '; opacity: 0.7"></i><p>400-500</p>';
        div.innerHTML += '<i style="background: ' + colors[3] + '; opacity: 0.7"></i><p>300-400</p>';
        div.innerHTML += '<i style="background: ' + colors[2] + '; opacity: 0.7"></i><p>200-300</p>';
        div.innerHTML += '<i style="background: ' + colors[1] + '; opacity: 0.9"></i><p><100-200</p>';
        div.innerHTML += '<i style="background: ' + colors[0] + '; opacity: 0.3"></i><p><100</p>';
        return div;
      };
    var tiles_legend = '<i style="background:red ; opacity: 0.5"></i><p><b>Cases</b></p>';
    var dilema_legend = '<i style="background: lightblue; opacity: 0.5"></i><p><b>Tweets</b></p>';
    var outrage_legend = '<i style="background: white; opacity: 0.5"></i><p><b>Income Level</b></p>';
    var heroism_legend = '<i style="background: green; opacity: 0.5"></i><p><b>Food Pantry</b></p>';
    var resilience_legend = '<i style="background: green; opacity: 0.5"></i><p><b>Forest</b></p>';

    // Collect coordinates of voluntary-based food pantries in NY State
    var agatha = L.marker([40.902705, -73.840120]).bindPopup('Agatha House Foundation-Mobile Pantry'),
    newlife = L.marker([40.897907, -73.851802]).bindPopup('New Life Holiness Caring Hands Food Pantry'),
    frances = L.marker([40.895848, -73.853502]).bindPopup('Church of St. Frances of Rome'),
    grace = L.marker([40.891204, -73.849463]).bindPopup('The Grace Of God Ministries Church Inc'),
    bethany = L.marker([40.886684, -73.851744]).bindPopup('Bronx Bethany Community Corporation'),
    iglesia = L.marker([40.888046, -73.831602]).bindPopup('Iglesia De Dios Pentecostal'),
    gospel = L.marker([40.885628, -73.854643]).bindPopup('Faith Apostolic Gospel Temple'),
    shiloh = L.marker([40.886619, -73.860426]).bindPopup('Shiloh Temple Pentecostal Church'),
    luke = L.marker([40.885230, -73.859005]).bindPopup('St. Luke Senior Community Program'),
    aids = L.marker([40.885346, -73.859021]).bindPopup('Unique People Services-AIDS Programs, Inc'),
    bravo = L.marker([40.873347, -73.879182]).bindPopup('Project Bravo at Montefiore Medical Ctr'),
    solution = L.marker([40.865473, -73.886285]).bindPopup('Part of the Solution (POTS)'),
    sda  = L.marker([40.872047, -73.850098]).bindPopup('Victory SDA Church'),
    forsaken = L.marker([40.871528, -73.843986]).bindPopup('ABUNDANT GRACE FOR THE FORSAKEN FOOD PANTRY'),
    missionary = L.marker([40.865537, -73.918965]).bindPopup('Worldwide Missionary Movement'),
    jewish = L.marker([40.858192, -73.864905]).bindPopup('Jewish Community Council of Pelham Parkway'),
    baptist = L.marker([40.845982, -73.866053]).bindPopup('Christ Jesus Baptist Church'),
    paul = L.marker([40.834839, -73.862362]).bindPopup('St. Paul Lutheran Church'),
    family = L.marker([40.822905, -73.818947]).bindPopup('Family Worship Center Church of God of Prophecy'),
    spanish = L.marker([40.817399, -73.860665]).bindPopup('Spanish Soundview SDA'),
    sound = L.marker([40.820955, -73.864967]).bindPopup('Soundview Presbyterian Church'),
    sheep = L.marker([40.826508, -73.878490]).bindPopup('Feed My Sheep Community Pantry'),
    west = L.marker([40.808268, -73.881395]).bindPopup('West Side Campaign Against Hunger'),
    living = L.marker([40.817079, -73.889377]).bindPopup('Bronx Works The Living Room'),
    bright = L.marker([40.817455, -73.886820]).bindPopup('Bright Temple AME Church'),
    act = L.marker([40.601401, -73.978656]).bindPopup('Acts Community Development Corp'),
    lady = L.marker([40.594589, -73.967348]).bindPopup('Our Lady of Grace Parish Ministry'),
    kings = L.marker([40.596412, -73.940569]).bindPopup('Kings Bay Y Senior Center'),
    salt = L.marker([40.576683, -73.983487]).bindPopup('Salt & Sea Mission Church Inc.'),
    masbia = L.marker([40.626162, -73.964902]).bindPopup('Masbia of Flatbush'),
    salvation = L.marker([40.623559, -74.032159]).bindPopup('Salvation Army Bay Ridge Corps'),
    project = L.marker([40.641268, -74.133099]).bindPopup('Project Hospitality Inc.'),
    staten = L.marker([40.620944, -74.082631]).bindPopup('Staten Island Liberian Community'),
    our = L.marker([40.631949, -74.087140]).bindPopup('Our Lady of Good Counsel Church'),
    ame = L.marker([40.588906, -73.804645]).bindPopup('Bethel AME Church');

    // var pantry = L.layerGroup([agatha, newlife,frances,grace,bethany, iglesia, gospel, shiloh,luke, aids, bravo, solution, sda,forsaken, missionary, jewish, baptist, paul,family,spanish,
    //   sound,sheep, west, living, bright, act, lady, kings,salt, masbia, salvation, project, staten, our, ame]);

    var layers = {
      tiles: {
            layer: L.tileLayer('http://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png', {
                maxZoom: 7,
                tms: true,
                attribution: 'Generated by QMetaTiles',
                detectRetina: true,
            }),
          },
      NY: {
        layer: L.tileLayer('http://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png')},
          cases: {
            layer: L.geoJson.ajax('assets/nycases.geojson', {
              style: style,
              onEachFeature: function (feature, layer) {
                layer.bindPopup("<h6>county:</h6>" + feature.properties.NAME + " " +"<h6>cases:</h6>" + feature.properties.cases + " " + "<h6>population:</h6>" + feature.properties.POP2010 + "" + "<h6>tested:</h6>" + feature.properties.test);
              }
            }), legend: newyork_legend
          },
      SD: {layer: L.tileLayer('assets/tiles/{z}/{x}/{y}.png')},
         dilema: {
             layer: L.geoJson.ajax('assets/twitter_socdis.geojson', {
                 color: 'orange',
                 weight: 2,
                 opacity: 0.3
             }), legend: dilema_legend
           },
       POV: {layer: L.tileLayer('assets/tiles/{z}/{x}/{y}.png')},
        out: {
            layer: L.geoJson.ajax('assets/nymedinco.geojson', {
              style: style,
              onEachFeature: function (feature, layer) {
                layer.bindPopup("<h6><b>County:</b></h6>" + feature.properties.NAME + " " +"<h6><b>Median Household Income ($):</b></h6>" + feature.properties.nystatepoverty_medinco);
              }
            }), legend: outrage_legend
          },
        PANT: {
          layer: L.layerGroup([agatha, newlife,frances,grace,bethany, iglesia, gospel, shiloh,luke, aids, bravo, solution, sda,forsaken, missionary, jewish, baptist, paul,family,spanish,
            sound,sheep, west, living, bright, act, lady, kings,salt, masbia, salvation, project, staten, our, ame])
        },

        GEE: {
            layer: L.tileLayer('http://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}'),
            legend: resilience_legend
        },

        satellite: {
            layer: L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoiamFrb2J6aGFvIiwiYSI6ImNpcms2YWsyMzAwMmtmbG5icTFxZ3ZkdncifQ.P9MBej1xacybKcDN_jehvw', {
                id: 'mapbox.satellite'
            })
        },

        mb1: {
            layer: L.tileLayer('https://styles/mapbox/dark-v10/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoiY2F0aGFyaW5hZGVwYXJpIiwiYSI6ImNrOXZ5ZGhyMDAxcngzZGxlbTkzamtuYjcifQ.y2t_yfvkZi3_Uvk8VAg4sA', {
                id: 'mapbox.dark'
            })
        },

        // antique: {
        //   layer: L.tileLayer('https://cartocdn_{s}.global.ssl.fastly.net/base-antique/{z}/{x}/{y}.png')}
        // },

        basemap: {
          layer: L.tileLayer('http://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png')}
        };

    // var control = {
    //   function ()
    // }


    var scenes = {
        overview: {lat: 44.0000000, lng: -123.5000000, zoom: 7, name: 'Cover Page', layers: []},
        newyork: {lat:42.541, lng: -75.291, zoom: 6.5, name: 'I Love New York', layers: [layers.tiles, layers.cases]}, // cases geojson, scale : NYS
        dilema: {lat:42.541, lng: -75.291, zoom: 6.5, name: 'Social Distancing', layers: [layers.dilema]}, //twitter geojson with marker, scale: NYS
        outrage: {lat:42.541, lng: -75.291, zoom: 6.5, name: 'Outrage', layers: [layers.out]}, // poverty, gunfires/protest in US states geojson, scale: NYS
        heroism: {lat:40.848, lng: -73.864, zoom: 8, name: 'Social Cohesion', layers: [layers.PANT]}, // food pantries for 3d map markers, scale: NYS
        resilience: {lat:42.541, lng: -75.291, zoom: 6.5, name: 'Changing the Mindset', layers: [layers.antique]}, // environment
        end: {lat: 44.0000000, lng: -123.5000000, zoom: 7, name: 'New Normal'}
    };

    L.control.layers({'Basemap':layers.basemap},{'tiles':layers.cases});

    $('#storymap').storymap({
        scenes: scenes,
        baselayer: layers.basemap,
        legend: true, // if you do not want a legend feature, you can simply not define the createLegend function.
        credits: "",
        loader: true,
        legend: true,
        scalebar: true,
        fly: false,
        scrolldown: true,
        progressline: true,
        navwidget: true,

        createMap: function () {
            // create a map in the "map" div, set the view to a given place and zoom
            var map = L.map($(".storymap-map")[0], {
                zoomControl: false, scrollWheelZoom: false, fadeAnimation: true,
                zoomAnimation: true
            }).setView([44, -120], 7);
            basemap = this.baselayer.layer.addTo(map)
            //add an miniglobe
            // new L.Control.GlobeMiniMap({
            //   marker: 'red',
            //   position: 'bottomright'
            // }).addTo(map);
            return map;
        }
    });
</script>
</body>
</html>
